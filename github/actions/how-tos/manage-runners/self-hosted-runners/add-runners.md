# Добавление собственных исполнителей (Adding self-hosted runners)

Вы можете добавить **собственного исполнителя (self-hosted runner)** в **репозиторий (repository)**, **организацию (organization)** или на уровень **предприятия (enterprise)**.

### В этой статье (In this article)

> **Внимание (Warning)**
>
> Мы рекомендуем использовать **собственных исполнителей (self-hosted runners)** только с **приватными репозиториями (private repositories)**. Это связано с тем, что **форки (forks)** вашего публичного репозитория могут потенциально запустить опасный код на машине вашего **собственного исполнителя (self-hosted runner)**, создав **запрос на слияние (pull request)**, который выполнит этот код в **сценарии автоматизации (workflow)**.
>
> Для получения дополнительной информации см. «Справочник по безопасному использованию (Secure use reference)».

### Предварительные требования (Prerequisites)

Перед добавлением **собственного исполнителя (self-hosted runner)** вам следует изучить, что это такое и как они работают. См. раздел «Собственные исполнители (Self-hosted runners)».

Кроме того, вы должны соответствовать следующим требованиям:
* У вас должен быть доступ к машине в вашей среде, которую вы планируете использовать в качестве **собственного исполнителя (self-hosted runner)**.

### Добавление собственного исполнителя в репозиторий (Adding a self-hosted runner to a repository)

Вы можете добавлять **собственных исполнителей (self-hosted runners)** в отдельный **репозиторий (repository)**. Чтобы добавить собственного исполнителя в пользовательский репозиторий, вы должны быть владельцем этого репозитория. Для репозитория организации вы должны быть **владельцем организации (organization owner)** или иметь **доступ администратора (admin access)** к репозиторию.

Для получения информации о том, как добавить собственного исполнителя с помощью **REST API**, см. раздел «Конечные точки REST API для собственных исполнителей (REST API endpoints for self-hosted runners)».

> **Примечание (Note)**
>
> Владельцы организации могут выбирать, каким репозиториям разрешено создавать **собственные исполнители уровня репозитория (repository-level self-hosted runners)**.
>
> Для получения дополнительной информации см. раздел «Отключение или ограничение Гитхаб Экшнс (GitHub Actions) для вашей организации».

1. На **Гитхабе (GitHub)** перейдите на главную страницу **репозитория (repository)**.

2. Под названием вашего репозитория нажмите **«Настройки» (Settings)**. Если вы не видите вкладку **«Настройки» (Settings)**, выберите **выпадающее меню (dropdown menu)**, а затем нажмите **«Настройки» (Settings)**.

3. В левой боковой панели (left sidebar) нажмите **«Действия» (Actions)**, а затем выберите **«Исполнители» (Runners)**.

4. Нажмите **«Новый собственный исполнитель» (New self-hosted runner)**.

5. Выберите образ операционной системы (operating system image) и архитектуру (architecture) машины вашего **собственного исполнителя (self-hosted runner)**.

6. Вы увидите инструкции, показывающие, как загрузить **приложение исполнителя (runner application)** и установить его на вашу машину **собственного исполнителя (self-hosted runner machine)**.

   Откройте **оболочку (shell)** на вашей машине собственного исполнителя (self-hosted runner machine) и выполните каждую команду оболочки (shell command) в указанном порядке.

   > **Примечание (Note)**
   >
   > В ОС **Виндоус (Windows)**, если вы хотите установить **приложение собственного исполнителя (self-hosted runner application)** в качестве **службы (service)**, вы должны открыть **оболочку (shell)** с **правами администратора (administrator privileges)**. Мы также рекомендуем использовать `C:\actions-runner` в качестве **директории (directory)** для приложения собственного исполнителя, чтобы **системные учетные записи Виндоус (Windows system accounts)** могли иметь доступ к **директории исполнителя (runner directory)**.

   Инструкции проведут вас через выполнение следующих задач:
   - **Загрузка и извлечение** приложения собственного исполнителя (self-hosted runner application).
   - **Запуск скрипта `config`** для конфигурации приложения собственного исполнителя и его регистрации в **Гитхаб Экшнс (GitHub Actions)**. Скрипту **`config`** требуется целевой **URL-адрес (destination URL)** и автоматически сгенерированный **ограниченный по времени токен (time-limited token)** для аутентификации запроса. Срок действия токена истекает через один час.
     - В ОС **Виндоус (Windows)** скрипт **`config`** также предложит установить приложение собственного исполнителя в качестве **службы (service)**. Для **Линукс (Linux)** и **макОС (macOS)** вы можете установить службу после завершения добавления исполнителя. Для получения дополнительной информации см. «Настройка приложения собственного исполнителя как службы (Configuring the self-hosted runner application as a service)».
   - **Запуск приложения собственного исполнителя** для подключения машины к **GitHub Actions**.

### Проверка успешного добавления собственного исполнителя (Checking that your self-hosted runner was successfully added)

После завершения шагов по добавлению **собственного исполнителя (self-hosted runner)**, сам исполнитель и его статус будут отображены в списке в разделе **«Исполнители» (Runners)**.

Для того чтобы исполнитель мог принимать **задания (jobs)**, приложение собственного исполнителя должно быть активно. Когда приложение исполнителя подключится к **Гитхабу (GitHub)** и будет готово к приему заданий, в **терминале (terminal)** машины появится следующее сообщение:

```text
√ Connected to GitHub

2019-10-24 05:45:56Z: Listening for Jobs
```

Для получения дополнительной информации см. раздел «Мониторинг и устранение неполадок собственных исполнителей (Monitoring and troubleshooting self-hosted runners)».

### Добавление собственного исполнителя в организацию (Adding a self-hosted runner to an organization)

Вы можете добавлять **собственных исполнителей (self-hosted runners)** на уровне **организации (organization level)**, где они могут использоваться для обработки **заданий (jobs)** для нескольких **репозиториев (repositories)** в этой организации. Чтобы добавить собственного исполнителя в организацию, вы должны быть **владельцем организации (organization owner)**. Для получения информации о том, как добавить собственного исполнителя с помощью **REST API (REST API)**, см. раздел «Конечные точки REST API для собственных исполнителей (REST API endpoints for self-hosted runners)».

1. На **Гитхабе (GitHub)** перейдите на главную страницу **организации (organization)**.
2. Под названием вашей организации нажмите **«Настройки» (Settings)**. Если вы не видите вкладку **«Настройки» (Settings)**, выберите **выпадающее меню (dropdown menu)**, а затем нажмите **«Настройки» (Settings)**.
3. В левой боковой панели (left sidebar) нажмите **«Действия» (Actions)**, затем нажмите **«Исполнители» (Runners)**.
4. Нажмите **«Новый исполнитель» (New runner)**, затем нажмите **«Новый собственный исполнитель» (New self-hosted runner)**.
5. Выберите образ операционной системы (operating system image) и архитектуру (architecture) машины вашего **собственного исполнителя (self-hosted runner machine)**.
6. Вы увидите инструкции, показывающие, как загрузить **приложение исполнителя (runner application)** и установить его на вашу машину **собственного исполнителя (self-hosted runner machine)**.

   Откройте **оболочку (shell)** на вашей машине собственного исполнителя (self-hosted runner machine) и выполните каждую **команду оболочки (shell command)** в указанном порядке.

   > **Примечание (Note)**
   >
   > В ОС **Виндоус (Windows)**, если вы хотите установить приложение собственного исполнителя (self-hosted runner application) как **службу (service)**, вы должны открыть оболочку (shell) с **правами администратора (administrator privileges)**. Мы также рекомендуем использовать `C:\actions-runner` в качестве **директории (directory)** для приложения собственного исполнителя, чтобы **системные учетные записи Виндоус (Windows system accounts)** могли иметь доступ к **директории исполнителя (runner directory)**.

   Инструкции проведут вас через выполнение следующих задач:
   - **Загрузка и извлечение** приложения собственного исполнителя (self-hosted runner application).
   - **Запуск скрипта настройки (config script)** для конфигурации приложения собственного исполнителя и его регистрации в **Гитхаб Экшнс (GitHub Actions)**. Скрипту настройки требуется целевой **URL-адрес (destination URL)** и автоматически сгенерированный **ограниченный по времени токен (time-limited token)** для **аутентификации (authenticate)** запроса. Срок действия токена истекает через один час.
     - В ОС **Виндоус (Windows)** скрипт настройки также предложит установить приложение собственного исполнителя в качестве **службы (service)**. Для **Линукс (Linux)** и **макОС (macOS)** вы можете установить службу после завершения добавления исполнителя. Для получения дополнительной информации см. «Настройка приложения собственного исполнителя как службы (Configuring the self-hosted runner application as a service)».
   - **Запуск приложения собственного исполнителя** для подключения машины к **Гитхаб Экшнс (GitHub Actions)**.

### Проверка успешного добавления собственного исполнителя (Checking that your self-hosted runner was successfully added)

После завершения шагов по добавлению **собственного исполнителя (self-hosted runner)**, сам исполнитель и его статус будут отображены в списке в разделе **«Исполнители» (Runners)**.

Для того чтобы исполнитель мог принимать **задания (jobs)**, приложение собственного исполнителя должно быть активно. Когда приложение исполнителя подключится к **Гитхабу (GitHub)** и будет готово к приему заданий, в **терминале (terminal)** машины появится следующее сообщение:

```text
√ Connected to GitHub

2019-10-24 05:45:56Z: Listening for Jobs
```

Для получения дополнительной информации см. раздел «Мониторинг и устранение неполадок собственных исполнителей (Monitoring and troubleshooting self-hosted runners)».

> **Примечание (Note)**
>
> По соображениям безопасности публичные репозитории (public repositories) по умолчанию не могут использовать исполнителей, находящихся в группе исполнителей (runner group), но вы можете переопределить это в настройках группы исполнителей. Для получения дополнительной информации см. раздел «Управление доступом к собственным исполнителям с помощью групп (Managing access to self-hosted runners using groups)».

### Добавление собственного исполнителя на уровень предприятия (Adding a self-hosted runner to an enterprise)

Если вы используете GitHub Enterprise Cloud, вы можете добавить собственных исполнителей на уровне предприятия (enterprise), где они могут быть назначены нескольким организациям (organizations). Владелец организации может контролировать, какие репозитории (repositories) могут их использовать. Для получения дополнительной информации см. документацию GitHub Enterprise Cloud.

### Следующие шаги (Next steps)

Вы можете настроить автоматизацию для масштабирования количества собственных исполнителей. Для получения дополнительной информации см. «Справочник по собственным исполнителям (Self-hosted runners reference)».